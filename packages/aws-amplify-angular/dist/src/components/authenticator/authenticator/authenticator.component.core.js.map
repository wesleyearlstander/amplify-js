{"version":3,"file":"authenticator.component.core.js","sourceRoot":"","sources":["../../../../../src/components/authenticator/authenticator/authenticator.component.core.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAeA,OAAO,EAAE,SAAS,EAAE,KAAK,EAA6B,MAAM,eAAe,CAAC;AAC5E,OAAO,EAAE,cAAc,EAAa,MAAM,oBAAoB,CAAC;AAE/D,IAAM,QAAQ,GAAG,ojDAiDhB,CAAC;;IAcD,oCAAmB,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;yBAP1B;YACtB,KAAK,EAAE,SAAS;YAChB,IAAI,EAAE,IAAI;SACV;6BACoB,EAAE;mCACO,UAAU;oBA2BvB,EAAE;QAxBlB,IAAI,CAAC,SAAS,EAAE,CAAC;KACjB;IAED,6CAAQ,GAAR;QAAA,iBAkBC;QAjBA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,EAAE;YAChC,MAAM,IAAI,KAAK,CAAC,uDAAuD,CAAC,CAAC;SACzE;aAAM;YACN,IAAM,UAAU,GAAG,IAAI,CAAC,cAAc;iBACpC,IAAI,EAAE;iBACN,wBAAwB,EAAE;iBAC1B,IAAI,CAAC,UAAA,IAAI;gBACT,IAAI,KAAI,CAAC,SAAS,CAAC,KAAK,KAAK,SAAS,IAAI,IAAI,EAAE;oBAC/C,KAAI,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,IAAI,MAAA,EAAE,CAAC,CAAC;iBAC9D;aACD,CAAC;iBACD,KAAK,CAAC,UAAA,CAAC;gBACP,IAAI,KAAI,CAAC,SAAS,CAAC,KAAK,KAAK,SAAS,EAAE;oBACvC,KAAI,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;iBAClE;aACD,CAAC,CAAC;SACJ;KACD;0BAMG,4CAAI;uBAAC,IAAS;YACjB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC;aACvC;YACD,IAAI,IAAI,CAAC,IAAI,EAAE;gBACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;aACtB;YAED,IAAI,CAAC,mBAAmB;gBACvB,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,mBAAmB,IAAI,UAAU,CAAC;;;;;0BAIhE,oDAAY;uBAAC,YAAiB;YACjC,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;;;;;0BAI/B,0DAAkB;uBAAC,kBAA0B;YAChD,IAAI,CAAC,mBAAmB,GAAG,kBAAkB,IAAI,UAAU,CAAC;;;;;IAG7D,8CAAS,GAAT;QAAA,iBAYC;QAXA,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,SAAS,CAC7C,UAAA,KAAK;YACJ,KAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACvB,EACD;YACC,KAAI,CAAC,SAAS,GAAG;gBAChB,KAAK,EAAE,QAAQ;gBACf,IAAI,EAAE,IAAI;aACV,CAAC;SACF,CACD,CAAC;KACF;IAED,+CAAU,GAAV,UAAW,IAAI;QACd,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,KAAK,IAAI,EAAb,CAAa,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;KAC1D;;gBA9ED,SAAS,SAAC;oBACV,QAAQ,EAAE,4BAA4B;oBACtC,QAAQ,UAAA;iBACR;;;;gBAxDQ,cAAc;;;yBAyFrB,KAAK;yBAGL,KAAK;iCAaL,KAAK;uCAKL,KAAK;;qCA9HP;;SAyEa,0BAA0B","sourcesContent":["// tslint:disable\r\n/*\r\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\r\n * the License. A copy of the License is located at\r\n *\r\n *     http://aws.amazon.com/apache2.0/\r\n *\r\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\r\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\r\n * and limitations under the License.\r\n */\r\n// tslint:enable\r\n\r\nimport { Component, Input, ViewEncapsulation, OnInit } from '@angular/core';\r\nimport { AmplifyService, AuthState } from '../../../providers';\r\n\r\nconst template = `\r\n  <div class=\"amplify-authenticator\">\r\n    <amplify-auth-sign-in-core\r\n      *ngIf=\"!shouldHide('SignIn')\"\r\n      [authState]=\"authState\"\r\n      [usernameAttributes]=\"_usernameAttributes\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-sign-in-core>\r\n\r\n    <amplify-auth-sign-up-core\r\n      *ngIf=\"!shouldHide('SignUp')\"\r\n      [authState]=\"authState\"\r\n      [signUpConfig]=\"_signUpConfig\"\r\n      [usernameAttributes]=\"_usernameAttributes\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-sign-up-core>\r\n\r\n    <amplify-auth-confirm-sign-up-core\r\n      *ngIf=\"!shouldHide('ConfirmSignUp')\"\r\n      [authState]=\"authState\"\r\n      [usernameAttributes]=\"_usernameAttributes\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-confirm-sign-up-core>\r\n\r\n    <amplify-auth-confirm-sign-in-core\r\n      *ngIf=\"!shouldHide('ConfirmSignIn')\"\r\n      [authState]=\"authState\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-confirm-sign-in-core>\r\n\r\n    <amplify-auth-forgot-password-core\r\n      *ngIf=\"!shouldHide('ForgotPassword')\"\r\n      [authState]=\"authState\"\r\n      [usernameAttributes]=\"_usernameAttributes\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-forgot-password-core>\r\n\r\n    <amplify-auth-greetings-core\r\n    *ngIf=\"!shouldHide('Greetings')\"\r\n    [authState]=\"authState\"\r\n    [usernameAttributes]=\"_usernameAttributes\"\r\n    ></amplify-auth-greetings-core>\r\n\r\n     <amplify-auth-require-new-password-core\r\n      *ngIf=\"!shouldHide('RequireNewPassword')\"\r\n      [authState]=\"authState\"\r\n      [hide]=\"hide\"\r\n    ></amplify-auth-require-new-password-core>\r\n  </div>\r\n`;\r\n\r\n@Component({\r\n\tselector: 'amplify-authenticator-core',\r\n\ttemplate,\r\n})\r\nexport class AuthenticatorComponentCore implements OnInit {\r\n\tauthState: AuthState = {\r\n\t\tstate: 'loading',\r\n\t\tuser: null,\r\n\t};\r\n\t_signUpConfig: any = {};\r\n\t_usernameAttributes: string = 'username';\r\n\r\n\tconstructor(public amplifyService: AmplifyService) {\r\n\t\tthis.subscribe();\r\n\t}\r\n\r\n\tngOnInit() {\r\n\t\tif (!this.amplifyService.auth()) {\r\n\t\t\tthrow new Error('Auth module not registered on AmplifyService provider');\r\n\t\t} else {\r\n\t\t\tconst loadStatus = this.amplifyService\r\n\t\t\t\t.auth()\r\n\t\t\t\t.currentAuthenticatedUser()\r\n\t\t\t\t.then(user => {\r\n\t\t\t\t\tif (this.authState.state === 'loading' && user) {\r\n\t\t\t\t\t\tthis.amplifyService.setAuthState({ state: 'signedIn', user });\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(e => {\r\n\t\t\t\t\tif (this.authState.state === 'loading') {\r\n\t\t\t\t\t\tthis.amplifyService.setAuthState({ state: 'signIn', user: null });\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t@Input()\r\n\thide: string[] = [];\r\n\r\n\t@Input()\r\n\tset data(data: any) {\r\n\t\tif (data.signUpConfig) {\r\n\t\t\tthis._signUpConfig = data.signUpConfig;\r\n\t\t}\r\n\t\tif (data.hide) {\r\n\t\t\tthis.hide = data.hide;\r\n\t\t}\r\n\r\n\t\tthis._usernameAttributes =\r\n\t\t\tdata.usernameAttributes || this._usernameAttributes || 'username';\r\n\t}\r\n\r\n\t@Input()\r\n\tset signUpConfig(signUpConfig: any) {\r\n\t\tthis._signUpConfig = signUpConfig;\r\n\t}\r\n\r\n\t@Input()\r\n\tset usernameAttributes(usernameAttributes: string) {\r\n\t\tthis._usernameAttributes = usernameAttributes || 'username';\r\n\t}\r\n\r\n\tsubscribe() {\r\n\t\tthis.amplifyService.authStateChange$.subscribe(\r\n\t\t\tstate => {\r\n\t\t\t\tthis.authState = state;\r\n\t\t\t},\r\n\t\t\t() => {\r\n\t\t\t\tthis.authState = {\r\n\t\t\t\t\tstate: 'signIn',\r\n\t\t\t\t\tuser: null,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tshouldHide(comp) {\r\n\t\treturn this.hide.filter(item => item === comp).length > 0;\r\n\t}\r\n}\r\n"]}